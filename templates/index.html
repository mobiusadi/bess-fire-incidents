<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Battery Failures Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
    <!-- Left: Scrollable Incident Cards -->
    <div class="left-pane">
        {% for incident in incidents %}
            <div class="card">
                <h3>{{ incident.Location }}</h3>
                <p><strong>Date:</strong> {{ incident["Event Date"] }}</p>
                <p><strong>Capacity:</strong> {{ incident["Capacity (MWh)"] }} MWh</p>
                {% for preview in incident.previews %}
                    <div class="preview">
                        <a href="{{ preview.url }}" target="_blank">
                            <strong>{{ preview.title }}</strong>
                        </a>
                        {% if preview.description %}<p>{{ preview.description }}</p>{% endif %}
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>

    <!-- Right: Graphs + Map -->
    <div class="right-pane">
        <div class="plot-container">
            <div id="graph1"></div>
            <div id="graph2"></div>
        </div>
        <div class="map-container">
            {{ map_html|safe }}
        </div>
    </div>
</div>

<script>
    Plotly.newPlot('graph1', {{ graph1_json|tojson }}, {});
    Plotly.newPlot('graph2', {{ graph2_json|tojson }}, {});
</script>
</body>
</html>
